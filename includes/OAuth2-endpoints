<h1 id='oauth-2-endpoints'>OAuth 2 Endpoints</h1><h2 id='presession'>Presession</h2>
<blockquote>
<p>Sample Request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s1">'http://api-gateway.test.itsd/api-gateway/pspl/auth/1.0/oauth/presession?client_id=pmobile2'</span> <span class="se">\</span>
</code></pre>
<blockquote>
<p>Sample Result</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="s2">"msg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Success"</span><span class="p">,</span><span class="w">
</span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
</span><span class="s2">"sessionID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3FABDBA8-ABC5-442A-BD02-D438193658E4"</span><span class="p">,</span><span class="w">
</span><span class="s2">"randomNo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7B205AE854B5B70EB6E6C1B374A1B2E886A56C0B"</span><span class="p">,</span><span class="w">
</span><span class="s2">"publicKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00C3537B3253203059000F13C3D7D262F5A2B20F029CB7D93AB0CF86A690617890B4900D07E6F2BB7455CFFCC523594D56E2C89314F4D410CB706C678A41183A9CC9BD2DFFA9E7657A553564DE21EDADD07213D76CB9D28A47BEE4761024E43592094C240935AC0D938179C621EEBDF9F93E7E393611758A311FCAB4B7F3928193:010001"</span><span class="p">,</span><span class="w">
</span><span class="s2">"touchIDEnabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
</span><span class="s2">"urls"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This function is to retrieve the precession information for E2EE (end to end encryption).</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET http://api-gateway.test.itsd/api-gateway/pspl/auth/1.0/oauth/presession</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>client_id</td>
<td></td>
<td>Client ID</td>
</tr>
</tbody></table>
<h2 id='authorize'>Authorize</h2>
<blockquote>
<p>Sample Request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code></code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json tab-json"><code></code></pre>
<p>For web server client to request access code which will be return code as client redirect URL as query string to request token to OAuth server. Client must be capable of dealing with browser.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET http://api-gateway.test.itsd/api-gateway/pspl/auth/1.0/oauth/authorize</code></p>
<h3 id='query-parameters-2'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>response_type</td>
<td></td>
<td>Must put the value ìcodeî</td>
</tr>
<tr>
<td>redirect_uri</td>
<td></td>
<td>Client browser redirect callback url e.g http://127.0.0.1:52798/</td>
</tr>
<tr>
<td>client_id</td>
<td></td>
<td>Client ID</td>
</tr>
<tr>
<td>state</td>
<td></td>
<td>CSRF Token</td>
</tr>
</tbody></table>
<h2 id='token'>Token</h2>
<blockquote>
<p>Sample Request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
http://api-gateway.test.itsd/api-gateway/pspl/auth/1.0/oauth/token <span class="se">\</span>
-H <span class="s1">'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW'</span> <span class="se">\</span>
-F <span class="nv">grant_type</span><span class="o">=</span>password <span class="se">\</span>
-F <span class="nv">client_id</span><span class="o">=</span>pmobile2 <span class="se">\</span>
-F <span class="nv">client_secret</span><span class="o">=</span> <span class="se">\</span>
-F <span class="nv">username</span><span class="o">=</span>0008090 <span class="se">\</span>
-F <span class="nv">password</span><span class="o">=</span>5AA40989EB296E2AAA3B0AB7B703717C715AA0116451947620A72B07BF01E3FF4AE61C6B3EFE923E73E9F6C2F08FE2334BDEA87E5B45338F07CB286623B5870CDA3884EE5379A2DA563E374601137B1A0099CC875AB61580689C5251BAD367734B3F9F04AE90055ADF557D7387CFDD967717512ED8BDE1F0DC59BFA1B736A9A7 <span class="se">\</span>
-F <span class="nv">sessionId</span><span class="o">=</span>B57CD515-1B3D-4600-8251-734FD6BAF08E
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOlsic2VydmVyMSJdLCJ1c2VyX25hbWUiOiJDdXN0b21pemVQcmluY2lwYWxDb25maWd1cmUgW3VzZXJBY2NvdW50Tm89MDAwODA5MCwgc2Vzc2lvbklkPUI1N0NENTE1LTFCM0QtNDYwMC04MjUxLTczNEZENkJBRjA4RSwgYWNjb3VudFR5cGU9XHUwMDAwXSIsInNjb3BlIjpbInJlYWQiXSwiYWNjb3VudE5vIjoiMDAwODA5MCIsImFjY291bnRUeXBlIjoiXHUwMDAwIiwic2Vzc2lvbklkIjoiQjU3Q0Q1MTUtMUIzRC00NjAwLTgyNTEtNzM0RkQ2QkFGMDhFIiwiZXhwIjoxNTI0MTI3MDU1LCJhdXRob3JpdGllcyI6WyJwbW9iaWxlIl0sImp0aSI6IjBlZGRhNjM4LWYxNjMtNDk5YS1hNjRjLWM3NzM1MDZmNGMxNCIsImNsaWVudF9pZCI6InBtb2JpbGUyIn0.f9kmVoJMhOiUSfe_wdflrjWZDHwXakgLQmz5FVR9xQBBMIOC9NA4r9Fu7JoX1H3f8vO19C6T-uOD5nyzYHlx7U9y0wssiOO3_knEt44bVRCpemqSXyaykAQoeW245ySbhs85UzKuzMONPGWdUNNGf0lbCdAFmdQ5vpqGCXFQ1Qz82sldEP0JZJKhgi8T6GoEWvYPt4fHxYo9ODmNO7t1mjU0IE_4tJKXxYBbt9KYMRg6VqrvFSmUFu5BQPODG2C7ZgbLF7QlUusKZc6q5ZfwNJnjYIuC-JgK9May-9F26DMT5QZz-9vt89yyLhbLb-S-ARimxA1N5BgxSRqCn4-LDQ"</span><span class="p">,</span><span class="w">
</span><span class="s2">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bearer"</span><span class="p">,</span><span class="w">
</span><span class="s2">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOlsic2VydmVyMSJdLCJ1c2VyX25hbWUiOiJDdXN0b21pemVQcmluY2lwYWxDb25maWd1cmUgW3VzZXJBY2NvdW50Tm89MDAwODA5MCwgc2Vzc2lvbklkPUI1N0NENTE1LTFCM0QtNDYwMC04MjUxLTczNEZENkJBRjA4RSwgYWNjb3VudFR5cGU9XHUwMDAwXSIsInNjb3BlIjpbInJlYWQiXSwiYWNjb3VudE5vIjoiMDAwODA5MCIsImFjY291bnRUeXBlIjoiXHUwMDAwIiwiYXRpIjoiMGVkZGE2MzgtZjE2My00OTlhLWE2NGMtYzc3MzUwNmY0YzE0Iiwic2Vzc2lvbklkIjoiQjU3Q0Q1MTUtMUIzRC00NjAwLTgyNTEtNzM0RkQ2QkFGMDhFIiwiZXhwIjoxNTI0MTYyMDU1LCJhdXRob3JpdGllcyI6WyJwbW9iaWxlIl0sImp0aSI6Ijg0MTQ5M2E2LWQwZTktNGQ0Zi1iN2IxLTg2ZjQ2NGQzMzM3OCIsImNsaWVudF9pZCI6InBtb2JpbGUyIn0.IroYemI4fdRrumW2asIik1AIzQ8hBddkLguEvVWg2CRiQrQA49spBnOZz8god6C0OMrkb9NuCDl184h7xaMuRwKA5O-i8Nx_sx-d_tMuM-bcuadsc_aCltnYdpZD6GuKZHaouR_TOB1u-bOmx3fziK_fpbsJrx2XYBG4vq6rGH1o9AYGITid5bIGdOPYRf0uZSLYvwUf57vXXf0Yd6hdc-RFIyKXZ3myfEQ1K20nQQPeuEx-FpQim0kJt4PdMiEr5ABXh3QYoRJCGvtTPM-_GjhZEZ5gSQBCmIZw5jOgafu-2MUEgzAn5wvO8lyQs2OFtvmALGCtFiZxqU6MoxRubw"</span><span class="p">,</span><span class="w">
</span><span class="s2">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">999</span><span class="p">,</span><span class="w">
</span><span class="s2">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"read"</span><span class="p">,</span><span class="w">
</span><span class="s2">"accountNo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0008090"</span><span class="p">,</span><span class="w">
</span><span class="s2">"accountType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\u</span><span class="s2">0000"</span><span class="p">,</span><span class="w">
</span><span class="s2">"sessionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"B57CD515-1B3D-4600-8251-734FD6BAF08E"</span><span class="p">,</span><span class="w">
</span><span class="s2">"jti"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0edda638-f163-499a-a64c-c773506f4c14"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>To request the JWT access token. Based on the grant_type, parameters could be varied.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>POST http://api-gateway.test.itsd/api-gateway/pspl/auth/1.0/oauth/token</code></p>
<h3 id='header-parameters'>Header Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Authorization</td>
<td>JWT token string(* Required if grant_type=client_credentials)</td>
</tr>
</tbody></table>
<h3 id='form-parameters'>Form Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>grant_type</td>
<td></td>
<td>Must put one of the below types: 1.Password 2.Client_credentials 3.Authorization_code 4.Refresh_token</td>
</tr>
<tr>
<td>code</td>
<td></td>
<td>Access code(* Required if grant_type= Authorization_code)</td>
</tr>
<tr>
<td>redirect_uri</td>
<td></td>
<td>Client browser redirect callback url e.g http://127.0.0.1:52798/ (* Required if grant_type= Authorization_code)</td>
</tr>
<tr>
<td>username</td>
<td></td>
<td>Login user id or name (* Required if grant_type=Password)</td>
</tr>
<tr>
<td>sessionId</td>
<td></td>
<td>User Session ID (* Required if grant_type=Password)</td>
</tr>
<tr>
<td>password</td>
<td></td>
<td>E2EE encrypted PIN (* Required if grant_type=Password)</td>
</tr>
<tr>
<td>client_id</td>
<td></td>
<td>Client ID (* Required if grant_type= Authorization_code /Password/Refresh_token)</td>
</tr>
<tr>
<td>client_secret</td>
<td></td>
<td>Client Secret (* Required if grant_type= Authorization_code Password/Refresh_token)</td>
</tr>
<tr>
<td>refresh_token</td>
<td></td>
<td>Token to generate new access token if expired. (* Required if grant_type=Refresh_token)</td>
</tr>
</tbody></table>
<h2 id='token-key'>Token Key</h2>
<blockquote>
<p>Sample Request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
http://api-gateway.test.itsd/api-gateway/pspl/auth/1.0/oauth/token_key <span class="se">\</span>
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="s2">"alg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SHA256withRSA"</span><span class="p">,</span><span class="w">
</span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-----BEGIN PUBLIC KEY-----</span><span class="se">\n</span><span class="s2">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyKeq/L2ErjE/Q+S9GfHPOgikqrfe/L0h4v/TpLGjUGEqYHBZnYT1vhXVsT/aHjfxXZ/cYvyUYldqcww6fCuY92Z7PfGjn5/zhnhtLcCDOWmeqw+Az2+/a2IPDdhja6Xaaxpr8PNyOfjWFkpN5U4JjMAkhPwRHqiUMVhbbTPqMXft5Y8FeYaBBNZNLHRvjlvlWJwFNDVtlwjjmplFRRrIeASpt+iU74rkZAqCfKzWiQM+L3IvaMY12NKYip/usqZVCofu8M0DG0mQiCfMpw71MlUfYQoXwQbHHTX3b7OS4iCYfsHCq5ItRm19yLlOaMJIpg2cpA7N4e9AxVvOyF5qUwIDAQAB</span><span class="se">\n</span><span class="s2">-----END PUBLIC KEY-----"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This function is to request the JWT access token public key for clients to verify token.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>GET http://api-gateway.test.itsd/api-gateway/pspl/auth/1.0/oauth/token_key</code></p>
<h2 id='check-token'>Check Token</h2>
<blockquote>
<p>Sample Request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s1">'http://api-gateway.test.itsd/api-gateway/pspl/auth/1.0/oauth/check_token?token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOlsic2VydmVyMSJdLCJ1c2VyX25hbWUiOiJDdXN0b21pemVQcmluY2lwYWxDb25maWd1cmUgW3VzZXJBY2NvdW50Tm89MDAwODA5MCwgc2Vzc2lvbklkPUI1N0NENTE1LTFCM0QtNDYwMC04MjUxLTczNEZENkJBRjA4RSwgYWNjb3VudFR5cGU9XHUwMDAwXSIsInNjb3BlIjpbInJlYWQiXSwiYWNjb3VudE5vIjoiMDAwODA5MCIsImFjY291bnRUeXBlIjoiXHUwMDAwIiwic2Vzc2lvbklkIjoiQjU3Q0Q1MTUtMUIzRC00NjAwLTgyNTEtNzM0RkQ2QkFGMDhFIiwiZXhwIjoxNTI0MTI3MDU1LCJhdXRob3JpdGllcyI6WyJwbW9iaWxlIl0sImp0aSI6IjBlZGRhNjM4LWYxNjMtNDk5YS1hNjRjLWM3NzM1MDZmNGMxNCIsImNsaWVudF9pZCI6InBtb2JpbGUyIn0.f9kmVoJMhOiUSfe_wdflrjWZDHwXakgLQmz5FVR9xQBBMIOC9NA4r9Fu7JoX1H3f8vO19C6T-uOD5nyzYHlx7U9y0wssiOO3_knEt44bVRCpemqSXyaykAQoeW245ySbhs85UzKuzMONPGWdUNNGf0lbCdAFmdQ5vpqGCXFQ1Qz82sldEP0JZJKhgi8T6GoEWvYPt4fHxYo9ODmNO7t1mjU0IE_4tJKXxYBbt9KYMRg6VqrvFSmUFu5BQPODG2C7ZgbLF7QlUusKZc6q5ZfwNJnjYIuC-JgK9May-9F26DMT5QZz-9vt89yyLhbLb-S-ARimxA1N5BgxSRqCn4-LDQ'</span> <span class="se">\</span>
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="s2">"aud"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span><span class="s2">"server1"</span><span class="w">
</span><span class="p">],</span><span class="w">
</span><span class="s2">"user_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CustomizePrincipalConfigure [userAccountNo=0008090, sessionId=B57CD515-1B3D-4600-8251-734FD6BAF08E, accountType=</span><span class="se">\u</span><span class="s2">0000]"</span><span class="p">,</span><span class="w">
</span><span class="s2">"scope"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span><span class="s2">"read"</span><span class="w">
</span><span class="p">],</span><span class="w">
</span><span class="s2">"accountNo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0008090"</span><span class="p">,</span><span class="w">
</span><span class="s2">"accountType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\u</span><span class="s2">0000"</span><span class="p">,</span><span class="w">
</span><span class="s2">"sessionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"B57CD515-1B3D-4600-8251-734FD6BAF08E"</span><span class="p">,</span><span class="w">
</span><span class="s2">"exp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1524127055</span><span class="p">,</span><span class="w">
</span><span class="s2">"authorities"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span><span class="s2">"pmobile"</span><span class="w">
</span><span class="p">],</span><span class="w">
</span><span class="s2">"jti"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0edda638-f163-499a-a64c-c773506f4c14"</span><span class="p">,</span><span class="w">
</span><span class="s2">"client_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pmobile2"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This function is to verify JWT access token with oauth server.</p>
<h3 id='http-request-5'>HTTP Request</h3>
<p><code>GET http://api-gateway.test.itsd/api-gateway/pspl/auth/1.0/oauth/check_token</code></p>
<h3 id='query-parameters-3'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>token</td>
<td></td>
<td>JWT access token to be varied</td>
</tr>
</tbody></table>
